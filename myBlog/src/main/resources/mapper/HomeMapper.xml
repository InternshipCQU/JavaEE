<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.demo.mapper.HomeMapper">
    <select id="tagToBlogs" resultType="com.example.demo.entity.blogInfo">
        SELECT blogInfo.blogTitle, blogInfo.blogContent, blogInfo.createTime,
            blogInfo.clickNum, blogInfo.likesNum, blogInfo.userId, blogInfo.tagId
        FROM blogInfo, blogTag, tagBlogInfo
        WHERE blogTag.tagId = #{tagId}
            AND blogTag.tagId = tagBlogInfo.tagId
            AND tagBlogInfo.blogId = blogInfo.blogId;
    </select>

    <select id="searchBlogs" resultType="com.example.demo.entity.blogInfo">
        SELECT blogInfo.blogTitle, blogInfo.blogContent, blogInfo.createTime,
            blogInfo.clickNum, blogInfo.likesNum, blogInfo.userId, blogInfo.tagId
        FROM blogInfo, blogTag, tagBlogInfo
        WHERE blogInfo.blogTitle = #{keyword}
            OR (blogTag.tagName = #{tagName}
                AND blogTag.tagId = tagBlogInfo.tagId
                AND tagBlogInfo.blogId = blogInfo.blogId);
    </select>


    <select id="showHotBlogger" resultType="com.example.demo.entity.User">
        SELECT `User`.username, `User`.avatar
        FROM `User` ORDER BY `User`.likesNum DESC limit 6;
    </select>


    <select id="showRecommendBlogger" resultType="com.example.demo.entity.User">
        SELECT `User`.username, `User`.avatar
        FROM `User`, userLike
        WHERE userLike.fansId = #{userId}
            AND userLike.userId = `User`.userId
        ORDER BY `User`.likesNum DESC limit 6;
    </select>

    <select id="getBlogs" resultType="com.example.demo.entity.blogInfo">
        SELECT blogInfo.blogTitle, blogInfo.blogContent, blogInfo.createTime,
            blogInfo.clickNum, blogInfo.likesNum, blogInfo.userId, blogInfo.tagId
        FROM blogInfo
        ORDER BY `blogInfo`.clickNum DESC limit 10;
    </select>
</mapper>
